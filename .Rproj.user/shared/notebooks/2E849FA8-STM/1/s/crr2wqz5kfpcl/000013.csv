"0","# STM 모델에서 theta 행렬 추출 (각 문서의 토픽 비중)"
"0","theta_matrix <- stm_model1$theta  # 각 행은 문서, 각 열은 토픽에 대한 비중"
"0",""
"0","# 토픽별로 매핑된 스킬과 가중치를 데이터프레임으로 정의"
"0","topic_skill_mapping <- data.frame("
"0","  Topic = 1:11,"
"0","  Skills = c(""Machine Learning, Neural Networks"",  # Topic 1"
"0","             """",                                    # Topic 2 (매핑 없음)"
"0","             ""Visual Image Recognition, Neural Networks"",  # Topic 3"
"0","             ""Artificial Intelligence"",             # Topic 4"
"0","             ""Machine Learning"",                    # Topic 5"
"0","             ""Robotics"",                            # Topic 6"
"0","             ""Generative Artificial Intelligence, Natural Language Processing (NLP)"",  # Topic 7"
"0","             ""Machine Learning"",                    # Topic 8"
"0","             ""Artificial Intelligence"",     # Topic 9"
"0","             ""Machine Learning"",                    # Topic 10"
"0","             ""Machine Learning""),                   # Topic 11"
"0","  Weights = c(0.5,    # Topic 1 (2개의 스킬)"
"0","              0,      # Topic 2 (매핑 없음)"
"0","              0.5,    # Topic 3 (2개의 스킬)"
"0","              1,      # Topic 4 (1개의 스킬)"
"0","              1,      # Topic 5 (1개의 스킬)"
"0","              1,      # Topic 6 (1개의 스킬)"
"0","              0.5,    # Topic 7 (2개의 스킬)"
"0","              1,      # Topic 8 (1개의 스킬)"
"0","              1,      # Topic 9 (1개의 스킬)"
"0","              1,      # Topic 10 (1개의 스킬)"
"0","              1       # Topic 11 (1개의 스킬)"
"0","  )"
"0",")"
"0",""
"0","# 각 문서별 스킬 비중 계산"
"0","skill_proportions <- data.frame("
"0","  Document = 1:nrow(theta_matrix)"
"0",")"
"0",""
"0","# 스킬 리스트"
"0","skills <- c(""Machine Learning"", ""Neural Networks"", ""Visual Image Recognition"", ""Artificial Intelligence"","
"0","            ""Robotics"", ""Generative Artificial Intelligence"", ""Natural Language Processing (NLP)"")"
"0",""
"0","# 스킬에 대한 비중 계산을 위한 초기화"
"0","for (skill in skills) {"
"0","  skill_proportions[[skill]] <- 0"
"0","}"
"0",""
"0","# 각 문서에 대해 스킬 비중 계산"
"0","for (doc in 1:nrow(theta_matrix)) {"
"0","  for (topic in 1:ncol(theta_matrix)) {"
"0","    if (topic_skill_mapping$Skills[topic] != """") {"
"0","      skill_list <- strsplit(topic_skill_mapping$Skills[topic], "", "")[[1]]"
"0","      weight <- topic_skill_mapping$Weights[topic]"
"0","      "
"0","      # 각 스킬에 대해 비중 계산"
"0","      for (skill in skill_list) {"
"0","        skill_proportions[doc, skill] <- skill_proportions[doc, skill] + theta_matrix[doc, topic] * weight"
"0","      }"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","# 결과 확인"
"0","head(skill_proportions)"
